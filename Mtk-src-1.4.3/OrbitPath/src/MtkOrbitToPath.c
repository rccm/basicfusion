/*===========================================================================
=                                                                           =
=                             MtkOrbitToPath                                =
=                                                                           =
=============================================================================

                         Jet Propulsion Laboratory
                                   MISR
                               MISR Toolkit

            Copyright 2005, California Institute of Technology.
                           ALL RIGHTS RESERVED.
                 U.S. Government Sponsorship acknowledged.

============================================================================*/

#include "MisrOrbitPath.h"
#include "MisrError.h"

static const int orbit_path[1000] = {
0,  0,   0,   0, 159, 175, 191, 206, 222,   5,  21, /* 0 - 10 */
   37,  53,  69,  85, 101, 116, 132, 148, 164, 180, /* 11 - 20 */
  196, 212, 228,  11,  26,  42,  58,  74,  90, 106, /* 21 - 30 */
  122, 138, 154,   0,   0,   0,   0,   0,   0,   0, /* 31 - 40 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 34 - 145 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* fill with zeros */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 131 - 140 */
    0,   0,   0,   0,   0,  32,  48,  64,  80,  95, /* 141 - 150 */
  111, 127, 143, 159, 175, 191, 207, 223,   5,  21, /* 151 - 160 */
   37,  53,  69,  85, 101, 117, 132, 148, 164, 180, /* 161 - 170 */
  196, 212, 228,  11,  27,  42,  58,  74,  90, 106, /* 171 - 180 */
  122, 138, 154, 170, 185, 201, 217, 233,  16,  32, /* 181 - 190 */
   48,  64,  80,  95, 111, 127, 143, 159, 175, 191, /* 191 - 200 */
  207, 223,   5,  21,  37,  53,  69,  85, 101, 117, /* 201 - 210 */
  133, 148, 164, 180, 196, 212, 228,  11,  27,  43, /* 211 - 220 */
   58,  74,  90, 106, 122, 138, 154, 170, 186, 201, /* 221 - 230 */
  217, 233,  16,  32,  48,  64,  80,  95, 111, 127, /* 231 - 240 */
  143, 159, 175, 191, 207, 223,   5,  21,  37,  53, /* 241 - 250 */
   69,  85, 101, 117, 133, 148, 164, 180, 196, 212, /* 251 - 260 */
  228,  11,  27,  43,  58,  74,  90, 106, 122, 138, /* 261 - 270 */
  154, 170, 186, 201, 217, 233,  16,  32,  48,  64, /* 271 - 280 */
   80,  96, 111, 127, 143, 159, 175, 191, 207, 223, /* 281 - 290 */
    6,  21,  37,  53,  69,  85, 101, 117, 133, 148, /* 291 - 300 */
  164, 180, 196, 212, 228,  11,  27,  43,  58,  74, /* 301 - 310 */
   90, 106, 122, 138, 154, 170, 186, 201, 217, 233, /* 311 - 320 */
   16,  32,  48,  64,  80,  96, 111, 127, 143, 159, /* 321 - 330 */
  175, 191, 207, 223,   6,  21,  37,  53,  69,  85, /* 331 - 340 */
  101, 117, 133, 149, 164, 180, 196, 212, 228,  11, /* 341 - 350 */
   27,  43,  59,  74,  90, 106, 122, 138, 154, 170, /* 351 - 360 */
  186, 202, 217, 233,  16,  32,  48,  64,  80,  96, /* 361 - 370 */
  112, 127, 143, 159, 175, 191, 207, 223,   6,  22, /* 371 - 380 */
   38,  53,  69,  85, 101, 117, 133, 149, 165, 181, /* 381 - 390 */
  196, 212, 228,  11,  27,  43,  59, 75,   91, 106, /* 391 - 400 */
  122, 138, 154, 170, 186, 202, 218,  1,   16,  32, /* 401 - 410 */
   48,  64,  80,  96, 112, 128, 144, 159, 175, 191, /* 411 - 420 */
  207, 223,   6,  22,  38,  54,  70,  85, 101, 117, /* 421 - 430 */
  133, 149, 165, 181, 197, 213, 228,  11,  27,  43, /* 431 - 440 */
   59,  75,  91, 107, 123, 138, 154, 170, 186, 202, /* 441 - 450 */
  218,   1,  17,  33,  49,  64,  80,  96, 112, 128, /* 451 - 460 */
  144, 160, 176, 192, 207, 223,   6,  22,  38,  54, /* 461 - 470 */
   70,  86, 102, 117, 133, 149, 165, 181, 197, 213, /* 471 - 480 */
  229,  12,  27,  43,  59,  75,  91, 107, 123, 139, /* 480 - 490 */
  155, 171, 186, 202, 218,   1,  17,  33,  49,  65, /* 491 - 500 */
   81,  96, 112, 128, 144, 160, 176, 192, 208, 224, /* 501 - 510 */
    6,  22,  38,  54,  70,  86, 102, 118, 134, 149, /* 511 - 520 */
  165, 181, 197, 213, 229,  12,  28,  44,  59,  75, /* 521 - 530 */
   91, 107, 123, 139, 155, 171, 187, 203, 218,   1, /* 531 - 540 */
   17,  33,  49,  65,  81,  97, 113, 128, 144,   0, /* 541 - 550 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 551 - 560 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 561 - 570 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 571 - 580 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 581 - 590 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 591 - 600 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 601 - 610 */
    0,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 611 - 620 */
    0,   0,   0,   0,   0,   0,   0,   0,  18,  34, /* 621 - 630 */
   49,  65,  81,   0,   0, 129, 145, 161, 177, 192, /* 631 - 640 */
  208, 224,   7,  23,  39,  55,  71,  87, 103, 118, /* 641 - 650 */
  134, 150, 166, 182, 198,   0,   0,   0,  28,  44, /* 651 - 660 */
    0,  76,  92, 108, 124, 140, 156, 171, 187, 203, /* 661 - 670 */
  219,   2,  18,  34,  50,  66,  81,  97, 113, 129, /* 671 - 680 */
  145, 161, 177, 193, 209, 225,   7,  23,  39,  55, /* 681 - 690 */
   71,  87,   0,   0, 135, 150, 166, 182, 198, 214, /* 691 - 700 */
  230 , 13,  29,  45,  61,  76,  92, 108, 124, 140, /* 701 - 710 */
  156, 172, 188, 204, 219,   2,  18,  34,  50,  66, /* 711 - 720 */
   82,  98, 114, 130, 145, 161, 177, 193, 209, 225, /* 721 - 730 */
    8,  24,  40, 55,   71,  87, 103, 119, 135, 151, /* 731 - 740 */
  167, 183, 199, 214, 230,  13,  29,  45,  61,  77, /* 741 - 750 */
   93, 109, 124, 140, 156, 172, 188, 204, 220,   3, /* 751 - 760 */
   19,  34,  50,  66,  82,  98, 114, 130, 146, 162, /* 761 - 770 */
  178, 193, 209, 225,   8,  24,  40,  56,  72,  88, /* 771 - 780 */
  103, 119, 135, 151, 167, 183, 199, 215, 231,  14, /* 781 - 790 */
   29,  45,  61,  77,  93, 109, 125, 141, 157, 172, /* 791 - 800 */
  188, 204, 220,   3,  19,  35,  51,  67,  83,  98, /* 801 - 810 */
  114, 130, 146, 162, 178, 194, 210, 226,   9,  24, /* 811 - 820 */
   40,  56,  72,  88, 104, 120, 136, 152, 168, 183, /* 821 - 830 */
  199, 215, 231,  14,  30,  46,  62,  78,  94, 110, /* 831 - 840 */
  125, 141, 157, 173, 189, 205, 221,   4,  20,  36, /* 841 - 850 */
   52,  68,  83,  99, 115, 131, 147, 163, 179, 195, /* 851 - 860 */
  211, 227,  10,  26,  41,  57,  73,   0, 105, 121, /* 861 - 870 */
  137, 153, 169, 185, 201, 217, 233,  16,  31,  47, /* 871 - 880 */
   63,  79,  95, 111, 127, 143, 159, 175, 191, 207, /* 881 - 890 */
  223,   6,  22,  38,  54,  69,  85, 101, 117, 133, /* 891 - 900 */
  149, 165, 181, 197, 213, 229,  12,  28,  44,  60, /* 901 - 910 */
   76,  92, 108, 124, 139, 155, 171, 187, 203, 219, /* 911 - 920 */
    2,  18,  34,  50,  66,  82,  98, 114, 130, 146, /* 921 - 930 */
  162, 178, 194, 210, 226,   9,  25,  41,  57,  73, /* 931 - 940 */
   89, 104, 120, 136, 152, 168, 184, 200, 216, 232, /* 941 - 950 */
   15,  31,  47,   0,  79,  95, 111,   0, 143, 159, /* 951 - 960 */
  175, 191, 207, 223,   6,  22,  38,  54,  70,  86, /* 961 - 970 */
  102,   0,   0,   0,   0,   0,   0,   0,   0,   0, /* 971 - 980 */
    0,   0,  61,  77,  93, 109, 125, 141, 157, 173, /* 981 - 990 */
  189, 205, 221,   4,  20,  36,  52,  68,  84       /* 991 - 999 */
};

/** \brief Given orbit number return path number
 *
 *  \return MTK_SUCCESS if successful.
 *
 *  \par Example:
 *  In this example, we get the path number of orbit 12115.
 *
 *  \code
 *  status = MtkOrbitToPath(12115, &path);
 *  \endcode
 */

MTKt_status MtkOrbitToPath(
  int orbit, /**< [IN] Orbit Number */
  int *path  /**< [OUT] Path Number */ )
{
  MTKt_status status_code;  /* Return status of this function */
  int first_path_num = 177; /* path number counted as first for 
                               purposes of converting orbit to path */

  if (path == NULL)
    MTK_ERR_CODE_JUMP(MTK_NULLPTR);

  if (orbit < 4)
    MTK_ERR_CODE_JUMP(MTK_OUTBOUNDS);

  if (orbit < 1000)
    if (orbit_path[orbit] == 0)
      return MTK_FAILURE;
    else
      *path = orbit_path[orbit];
  else
    *path = (first_path_num - 1 + orbit * 16) % 233 + 1;

  return MTK_SUCCESS;

ERROR_HANDLE:
  return status_code;
}
